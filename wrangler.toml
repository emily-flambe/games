name = "games"
main = "src/index.ts"
compatibility_date = "2024-12-30"

# Production routes (not inherited by preview)
[env.production]
routes = [
  { pattern = "games.emilycogsdill.com/*", zone_name = "emilycogsdill.com" }
]

[dev]
port = 8777

# Durable Objects
[[durable_objects.bindings]]
name = "GAME_SESSIONS"
class_name = "GameSession"

[[durable_objects.bindings]]
name = "CHECKBOX_SESSIONS"
class_name = "CheckboxGameSession"

[[durable_objects.bindings]]
name = "EVERYBODY_VOTES_SESSIONS"
class_name = "EverybodyVotesGameSession"

[[durable_objects.bindings]]
name = "COUNTY_GAME_SESSIONS"
class_name = "CountyGameSession"

[[durable_objects.bindings]]
name = "GAME_REGISTRY"
class_name = "GameSessionRegistry"

# Durable Object Migrations
[[migrations]]
tag = "v1"
new_classes = [ "GameSession" ]

[[migrations]]
tag = "v2"
new_classes = [ "GameSessionRegistry" ]

[[migrations]]
tag = "v3"
new_classes = [ "CheckboxGameSession", "EverybodyVotesGameSession" ]

[[migrations]]
tag = "v4"
new_classes = [ "CountyGameSession" ]

# Preview deployments now use aliased preview URLs with commit hashes
# No separate preview environment needed - aliases are created automatically
# Format: https://preview-{commit-hash}-games.emily-cogsdill.workers.dev